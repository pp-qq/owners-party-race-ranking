# 徒競走結果管理アプリ 仕様書

## 概要
本アプリは、Firebase Hosting、Firestore、Cloud Run（FastAPI）、Next.jsを用いて構築する徒競走の結果管理アプリです。タイム計測、参加者管理、ランキング表示、記録更新などの機能を備えています。

## 技術構成
- フロントエンド: Next.js（Firebase Hostingで公開）
- バックエンド: FastAPI（Cloud Runで稼働）
- データベース: Firestore
- ホスティング: Firebase Hosting

## 主な機能

### 1. タイム計測・ラップ機能
- スタートボタンで計測開始。
- ラップボタンで複数人のタイムを記録。
- ストップボタンで計測終了。
- ラップごとにID入力欄が追加され、各ラップタイムに対応するIDを入力可能。
- タイマーリセットでラップタイムも全てリセット。

### 2. 記録登録・更新
- ID入力欄に参加者IDを入力。
- 入力したIDからDB（Firestore）で名前を取得し表示。
- OKボタンでタイム・ID・名前をDBに登録。
- 既存参加者の場合は記録を更新。
- 新規参加者の場合は新規登録画面へ遷移し、名前等を登録可能。

### 3. ランキング表示
- DBから取得したid, name, timeのカラムを持つランキングテーブルを常時表示。
- 記録更新時はリアルタイムでランキングを更新。

### 4. 参加者管理
- 新しい参加者を登録する機能。
- 参加者ID・名前等を入力しDBに登録。

## 画面構成

### タイム計測画面
- タイマー表示
- スタート/ラップ/ストップ/リセットボタン
- ラップごとにID入力欄とOKボタン
- ランキングテーブル（id, name, time）

### 参加者登録画面
- 参加者ID入力欄
- 名前入力欄
- 登録ボタン

## データベース設計（Firestore）
- コレクション: participants
  - id: string（参加者ID）
  - name: string（名前）
  - times: number

- コレクション: races
  - race_id: string
  - participants: array（参加者ID）
  - times: array（タイム）
  - date: datetime

## API設計（FastAPI）
- GET /ranking: ランキング取得
- POST /record: 記録登録・更新
- POST /participant: 参加者新規登録
- GET /participant/{id}: 参加者情報取得

## その他
- Firestoreのセキュリティルール設定
- Cloud Run/Hostingのデプロイ手順

---

この仕様書は初期案です。詳細設計・画面イメージ・API仕様は今後追加します。